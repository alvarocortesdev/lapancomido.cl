---
phase: 04-arquitectura-split-limpieza
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/pages/DashboardPage.jsx
  - apps/web/src/pages/ForgotPasswordPage.jsx
  - apps/web/src/components/admin/*
  - apps/web/src/components/customer/*
  - apps/web/src/components/LoginForm.jsx
  - apps/web/src/components/RegisterForm.jsx
  - apps/web/src/components/ProductForm.jsx
  - apps/web/src/layouts/AdminLayout.jsx
  - apps/web/src/hooks/useEncrypt.jsx
  - apps/web/src/hooks/useStorage.jsx
  - apps/web/src/hooks/useProductImages.jsx
  - apps/web/src/helpers/fakeStoreAPI.jsx
  - apps/web/src/helpers/roles.jsx
  - apps/web/src/helpers/validateRut.helper.js
autonomous: true

must_haves:
  truths:
    - "Build de apps/web completa sin errores"
    - "Bundle JS < 800KB (actualmente 1,234KB)"
    - "No existen archivos de auth/cart/customer en apps/web"
  artifacts:
    - path: "apps/web/src/pages/"
      provides: "Solo páginas usadas (HomePage, CatalogPage, Page404)"
    - path: "apps/web/src/components/"
      provides: "Sin carpetas admin/ ni customer/"
  key_links:
    - from: "apps/web/src/router/RouterManager.jsx"
      to: "pages/"
      via: "imports"
      pattern: "Solo importa HomePage, CatalogPage, Page404"
---

<objective>
Eliminar todo el código legacy de autenticación de clientes, carrito, checkout y componentes admin del frontend público.

Purpose: Reducir el bundle JS de 1,234KB a menos de 800KB y dejar el frontend limpio sin rastros del e-commerce antiguo.
Output: Frontend público sin código legacy, build funcionando, bundle reducido.
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-arquitectura-split-limpieza/04-CONTEXT.md
@apps/web/src/router/RouterManager.jsx
@apps/web/src/App.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Eliminar páginas y layouts no usados</name>
  <files>
    apps/web/src/pages/DashboardPage.jsx
    apps/web/src/pages/ForgotPasswordPage.jsx
    apps/web/src/layouts/AdminLayout.jsx
  </files>
  <action>
    Eliminar los siguientes archivos que no están en uso:
    - `apps/web/src/pages/DashboardPage.jsx` - No referenciado en RouterManager
    - `apps/web/src/pages/ForgotPasswordPage.jsx` - No referenciado en RouterManager
    - `apps/web/src/layouts/AdminLayout.jsx` - No usado, admin será en apps/admin
    
    Usar `rm` para eliminar cada archivo.
    No hay imports que corregir porque estos archivos ya no se importan en ningún lado.
  </action>
  <verify>
    ```bash
    ls apps/web/src/pages/DashboardPage.jsx 2>/dev/null && echo "FAIL: still exists" || echo "OK: deleted"
    ls apps/web/src/pages/ForgotPasswordPage.jsx 2>/dev/null && echo "FAIL: still exists" || echo "OK: deleted"
    ls apps/web/src/layouts/AdminLayout.jsx 2>/dev/null && echo "FAIL: still exists" || echo "OK: deleted"
    ```
  </verify>
  <done>
    Los 3 archivos eliminados, no quedan referencias rotas.
  </done>
</task>

<task type="auto">
  <name>Task 2: Eliminar componentes admin, customer y auth</name>
  <files>
    apps/web/src/components/admin/EditarCatalogo.jsx
    apps/web/src/components/admin/EditarUsuarios.jsx
    apps/web/src/components/admin/PedidosHistoricos.jsx
    apps/web/src/components/admin/PedidosPendientes.jsx
    apps/web/src/components/admin/ProductForm.jsx
    apps/web/src/components/admin/ResumenTienda.jsx
    apps/web/src/components/customer/MiCuenta.jsx
    apps/web/src/components/customer/MisDatos.jsx
    apps/web/src/components/customer/MisDirecciones.jsx
    apps/web/src/components/customer/MisFavoritos.jsx
    apps/web/src/components/customer/MisPedidos.jsx
    apps/web/src/components/LoginForm.jsx
    apps/web/src/components/RegisterForm.jsx
    apps/web/src/components/ProductForm.jsx
  </files>
  <action>
    Eliminar carpetas y archivos completos:
    
    ```bash
    rm -rf apps/web/src/components/admin/
    rm -rf apps/web/src/components/customer/
    rm apps/web/src/components/LoginForm.jsx
    rm apps/web/src/components/RegisterForm.jsx
    rm apps/web/src/components/ProductForm.jsx
    ```
    
    Estos componentes eran parte del e-commerce antiguo:
    - admin/* → Se reconstruirá en apps/admin en Phase 6
    - customer/* → Funcionalidad de clientes eliminada (no hay clientes, solo cotización)
    - LoginForm/RegisterForm → Auth de clientes eliminado
    - ProductForm → Duplicado del que está en admin/
    
    No hay imports que corregir - estos componentes no se usan en RouterManager ni en ningún componente activo.
  </action>
  <verify>
    ```bash
    ls apps/web/src/components/admin/ 2>/dev/null && echo "FAIL: admin/ still exists" || echo "OK: admin/ deleted"
    ls apps/web/src/components/customer/ 2>/dev/null && echo "FAIL: customer/ still exists" || echo "OK: customer/ deleted"
    ls apps/web/src/components/LoginForm.jsx 2>/dev/null && echo "FAIL" || echo "OK"
    ls apps/web/src/components/RegisterForm.jsx 2>/dev/null && echo "FAIL" || echo "OK"
    ```
  </verify>
  <done>
    Carpetas admin/ y customer/ eliminadas, LoginForm, RegisterForm y ProductForm eliminados.
  </done>
</task>

<task type="auto">
  <name>Task 3: Eliminar hooks y helpers legacy, verificar build y bundle</name>
  <files>
    apps/web/src/hooks/useEncrypt.jsx
    apps/web/src/hooks/useStorage.jsx
    apps/web/src/hooks/useProductImages.jsx
    apps/web/src/helpers/fakeStoreAPI.jsx
    apps/web/src/helpers/roles.jsx
    apps/web/src/helpers/validateRut.helper.js
  </files>
  <action>
    1. Eliminar hooks no usados:
    ```bash
    rm apps/web/src/hooks/useEncrypt.jsx
    rm apps/web/src/hooks/useStorage.jsx
    rm apps/web/src/hooks/useProductImages.jsx
    ```
    
    2. Eliminar helpers legacy:
    ```bash
    rm apps/web/src/helpers/fakeStoreAPI.jsx
    rm apps/web/src/helpers/roles.jsx
    rm apps/web/src/helpers/validateRut.helper.js
    ```
    
    Estos archivos son legacy del e-commerce:
    - useEncrypt → Usado para encriptar datos de pago
    - useStorage → LocalStorage para carrito
    - useProductImages → Ya no se usa (imágenes vienen de API)
    - fakeStoreAPI → Mock data de pruebas
    - roles → Roles de usuario cliente
    - validateRut → Validación de RUT chileno para clientes
    
    3. Verificar que no hay imports rotos:
    ```bash
    grep -r "useEncrypt\|useStorage\|useProductImages\|fakeStoreAPI\|roles\.jsx\|validateRut" apps/web/src/ --include="*.jsx" --include="*.js"
    ```
    
    Si hay imports rotos, eliminarlos del archivo que los importa.
    
    4. Ejecutar build para verificar:
    ```bash
    npm run --prefix apps/web build
    ```
    
    5. Verificar tamaño del bundle (debe ser < 800KB):
    El output del build muestra el tamaño. Buscar línea con `index-*.js`.
  </action>
  <verify>
    ```bash
    npm run --prefix apps/web build 2>&1 | grep "index-.*\.js" | awk '{print $1, $2}'
    # Debe mostrar tamaño < 800 kB
    ```
  </verify>
  <done>
    - 6 archivos de hooks/helpers eliminados
    - Build completa sin errores
    - Bundle JS menor a 800KB
  </done>
</task>

</tasks>

<verification>
1. `npm run --prefix apps/web build` completa sin errores
2. Bundle size < 800KB (verificar output del build)
3. `npm run --prefix apps/web dev` funciona y el catálogo se ve correctamente
4. No existen carpetas `admin/` ni `customer/` en `apps/web/src/components/`
5. No existen archivos eliminados listados arriba
</verification>

<success_criteria>
- Build de apps/web exitoso sin errores
- Bundle JS reducido de 1,234KB a menos de 800KB
- Catálogo funciona igual que antes (selección, cotización, WhatsApp)
- Sin archivos legacy de auth/cart/customer en el codebase
</success_criteria>

<output>
After completion, create `.planning/phases/04-arquitectura-split-limpieza/04-01-SUMMARY.md`
</output>
